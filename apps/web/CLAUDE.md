# apps/web

TanStack Start + React + Tailwind v4 + Paraglide i18n. Port 3000.

## Entry Points

- `src/server.ts` — Nitro server handler (env validation, Paraglide middleware)
- `src/router.tsx` — TanStack Router setup (SSR, query integration, Paraglide URL rewrite)
- `src/routeTree.gen.ts` — auto-generated route tree (do not edit)

## Key Directories

```
src/
  routes/           File-based routing (TanStack Router)
  components/
    landing/          Landing page sections
    admin/            Admin UI
    consent/          Consent banner/modal
    settings/         User settings
    avatar/           Avatar selection
    legal/            Legal page layouts
    mdx/              MDX rendering (Mermaid, CodeBlock)
    presentation/     Presentation components
  lib/
    api.ts            API client
    config.ts         App configuration
    env.server.ts     Server env validation (Zod)
    env.shared.ts     Shared env validation
    consent/          Consent logic (server, parsing, hooks)
    avatar/           Avatar generation (DiceBear)
    permissions.ts    Permission helpers
  hooks/            Custom React hooks
  integrations/     TanStack Query setup + devtools
  config/           App configs (legal.config.ts)
  paraglide/        Generated i18n (gitignored)
  styles.css        Tailwind + Fumadocs themes + @repo/ui theme
```

## Scripts

```bash
bun run dev        # vite dev
bun run build      # vite build
bun run test       # vitest run
bun run typecheck  # tsc --noEmit
bun run codegen    # paraglide compile + tsr generate
```

## i18n (Paraglide)

- Config: `project.inlang/settings.json`
- Locales: `en` (base), `fr`
- Messages: `project.inlang/messages/{locale}.json`
- Output: `src/paraglide/` (compiled, gitignored — regenerated by `codegen`)
- Vite plugin: strategy = cookie + preferredLanguage + url + baseLocale
- Validate: `bun run i18n:validate` (root script)

## Styling

- Tailwind v4 via `@tailwindcss/vite` plugin
- Sources scan `../node_modules/@repo/ui/src` for component classes
- Dark mode variant, view transitions, TailwindCSS Animate

## Key Dependencies

TanStack Router + Start + Query + Form + Table | shadcn/ui (Radix) | Lucide icons | Sonner toasts | better-auth | Fumadocs (MDX docs) | Nitro (dev proxy to API :4000)

## Standards

Read [frontend-patterns.mdx](../../docs/standards/frontend-patterns.mdx) before writing web code.

## Deploy

Vercel (TanStack/Nitro) — `main` = prod, `staging` = preview.

## Gotchas

- Paraglide i18n: compiled during codegen, `src/paraglide/` is gitignored. Run `bun run codegen` after changing messages.
- `routeTree.gen.ts` is auto-generated — never edit manually. Run `bun run codegen` or `tsr generate`.
- Nitro dev proxy forwards `/api` to `localhost:4000` — API must be running.
- Env validation: `VITE_*` vars validated at build time via Zod schema in `vite.config.ts`.
