---
title: "Setup: Docker Compose for Local Development"
description: Docker Compose configuration providing PostgreSQL with zero manual setup for local development
status: implemented
---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.

## Overview

Add a `docker-compose.yml` to the project root providing PostgreSQL 16 for local development. This eliminates the manual `createdb` step and ensures every developer gets an identical database setup with one command.

This is a **hard prerequisite** for #19 (Auth + Users) and all downstream backend features.

## Goals

- Zero manual database setup — `docker compose up -d` and done
- Data persistence across container restarts
- Health checks so dependent services can wait for readiness
- Convenience scripts (`bun db:up` / `bun db:down`) at root level
- Updated getting-started docs reflecting the new workflow

## Non-Goals

- Redis or other services (add when needed, e.g., #60 Background Jobs)
- pgAdmin or other GUI tools (Drizzle Studio via `bun db:studio` is sufficient)
- Production Docker configuration (separate concern, see #52)
- Multi-database setups (single `roxabi` database for now)

## Technical Design

### Docker Compose Configuration

```yaml
# docker-compose.yml
services:
  postgres:
    image: postgres:16-alpine
    container_name: roxabi-postgres
    restart: unless-stopped
    ports:
      - "5432:5432"
    environment:
      POSTGRES_USER: roxabi
      POSTGRES_PASSWORD: roxabi
      POSTGRES_DB: roxabi
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U roxabi"]
      interval: 5s
      timeout: 5s
      retries: 5

volumes:
  postgres_data:
```

**Key decisions:**
- `postgres:16-alpine` — PostgreSQL 16 LTS, minimal image size
- Named volume `postgres_data` — survives `docker compose down`, only removed with `docker compose down -v`
- Health check — enables `depends_on` with `condition: service_healthy` for future services
- Default credentials `roxabi/roxabi` — local dev only, clearly documented

### Environment Variables

The `DATABASE_URL` in `.env.example` files will be updated to match the compose defaults:

```bash
DATABASE_URL=postgresql://roxabi:roxabi@localhost:5432/roxabi
```

This replaces the current generic `user:password` placeholder.

### Convenience Scripts

Root `package.json` scripts:

| Script | Command | Description |
|--------|---------|-------------|
| `db:up` | `docker compose up -d` | Start PostgreSQL in background |
| `db:down` | `docker compose down` | Stop PostgreSQL (preserves data) |

### Documentation Updates

**`docs/getting-started.mdx`:**
- Add [Docker](https://www.docker.com/) to prerequisites (alongside Bun, Git, GitHub CLI)
- Change PostgreSQL prerequisite from `>= 15` to `>= 16` (matches compose image)
- Replace step "8. Configure the Database" (`createdb my_project_dev`) with Docker workflow:
  ```bash
  bun db:up
  docker compose ps  # verify healthy
  ```
- Add `bun db:up` / `bun db:down` to the "Useful Commands" table

**`docs/configuration.mdx`:**
- Add Docker to prerequisites section
- Update `DATABASE_URL` example in "Required Variables" table to `postgresql://roxabi:roxabi@localhost:5432/roxabi`

## Files Changed

| File | Action | Description |
|------|--------|-------------|
| `docker-compose.yml` | Create | PostgreSQL 16 service with health check |
| `.env.example` | Update | Align `DATABASE_URL` with compose defaults |
| `apps/api/.env.example` | Update | Align `DATABASE_URL` with compose defaults |
| `package.json` | Update | Add `db:up` and `db:down` scripts |
| `docs/getting-started.mdx` | Update | Replace manual `createdb` with Docker workflow, add Docker prerequisite, fix PostgreSQL version to 16 |
| `docs/configuration.mdx` | Update | Add Docker prerequisite, align `DATABASE_URL` example with compose defaults |

## Acceptance Criteria

- [ ] `docker compose up -d` starts PostgreSQL without errors
- [ ] `docker compose ps` shows `healthy` status
- [ ] `DATABASE_URL` from `.env.example` connects to the container
- [ ] Data persists after `docker compose down && docker compose up -d`
- [ ] `bun db:up` / `bun db:down` work from project root
- [ ] Getting started docs reflect the Docker workflow
- [ ] Docker is listed as a prerequisite in getting-started docs

## Dependencies

**Blocks:** #19 (Auth + Users requires a running database)
