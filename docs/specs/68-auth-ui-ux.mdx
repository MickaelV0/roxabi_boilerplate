---
title: "Auth UI/UX (Login, Register, Reset, Org pages)"
description: Polished authentication pages, organization management UI, and shared auth components for the Roxabi boilerplate.
---

## Context

Issue #19 (Auth + Users) delivered the complete authentication backend and **minimal/headless** frontend pages — bare functional forms with no visual polish. This spec covers the UI/UX layer: polished auth pages, new pages for flows that were missing, organization management UI, and reusable auth components.

**Dependency:** #19 Auth + Users (Better Auth) — **CLOSED**. All backend endpoints are functional.

**Promoted from:** [#68 Auth UI/UX Analysis](/docs/analyses/68-auth-ui-ux)

**Related:**
- [Spec: #19 Auth + Users](/docs/specs/19-auth-users)
- [Analysis: #19 Auth + Users](/docs/analyses/19-auth-users)

## Goal

Transform the minimal auth pages into a production-quality authentication experience with:
- Polished, accessible, responsive auth pages with proper form validation and feedback
- Complete auth flow coverage (including reset confirmation, email verification, magic link sent)
- Organization management UI (switcher, settings, members, invitations)
- Reusable shared components (OAuthButton, PasswordInput, Sonner toast)
- Full i18n support via Paraglide JS

## Users &amp; Use Cases

| User | Use Case | Pages/Components |
|------|----------|------------------|
| New visitor | Register for an account via email or OAuth | Register page |
| Returning user | Sign in with email/password, OAuth, or magic link | Login page |
| User who forgot password | Request reset link, then set new password | Reset Request + Reset Confirmation pages |
| User verifying email | Click email link, see verification status | Email Verification page |
| User using magic link | Request magic link, see confirmation | Login page → Magic Link Sent page |
| Org owner | Create org, edit settings, invite members | Org Settings, Invite modal |
| Org admin/member | Switch between orgs, view members | Org Switcher, Members List |

## Expected Behavior

### Happy path

#### Login (email/password)

1. User navigates to `/login`
2. AuthLayout renders centered card with branding
3. User enters email and password
4. Inline validation: email format, password not empty
5. User optionally checks "Remember me" (extends session to 30 days)
6. User clicks "Sign in" → button shows loading spinner, form disabled
7. Success → toast "Signed in successfully" → redirect to `/`
8. Failure → inline error below form ("Invalid credentials")

#### Login (OAuth)

1. User clicks "Sign in with Google" or "Sign in with GitHub" (branded OAuthButton)
2. Redirect to provider → callback → session created
3. Success → redirect to `/`
4. Failure → redirect to `/login` with error query param → inline error displayed

#### Login (Magic link)

1. User enters email in magic link section, clicks "Send magic link"
2. Loading state on button
3. Success → redirect to `/magic-link-sent` with email in state
4. `/magic-link-sent` page shows: "Check your email" message with the email address, "Didn't receive it?" resend option

#### Register

1. User navigates to `/register`
2. User enters name, email, password
3. Inline validation: name not empty, email format, password against strength rules
4. PasswordInput shows strength bar (red→orange→yellow→green) + rules checklist:
   - 8+ characters
   - At least one uppercase letter
   - At least one number
   - At least one symbol
5. User clicks "Create account" → loading state
6. Success → toast "Account created" → message "Check your email to verify your account"
7. OAuth buttons available as alternative: "Sign up with Google" / "Sign up with GitHub"

#### Password Reset

1. User navigates to `/reset-password`
2. User enters email, clicks "Send reset link" → loading state
3. Success → toast "Reset link sent" → message "Check your email"
4. User clicks link in email → navigates to `/reset-password/confirm?token=...`
5. Reset Confirmation page reads token from URL search params
6. User enters new password (with PasswordInput strength indicator)
7. Clicks "Reset password" → loading state
8. Success → toast "Password updated" → redirect to `/login`
9. Invalid/expired token → error message with link to request a new reset

#### Email Verification

1. User clicks verification link in email → navigates to `/verify-email?token=...`
2. Page automatically submits token to Better Auth
3. Success → "Email verified successfully" + link to continue to app
4. Invalid/expired token → "Verification failed" + option to resend verification email

#### Organization Switcher

1. Org switcher appears in the Header when user is authenticated and has 1+ organizations
2. Dropdown shows list of user's orgs with name and role badge
3. Active org is highlighted
4. Clicking an org calls `authClient.organization.setActive({ organizationId })` → page reloads context
5. Bottom of dropdown: "Create organization" option → opens create org dialog

#### Organization Settings (`/org/settings`)

1. Shows current org name, slug, and logo
2. Owner can edit name and slug
3. Owner can upload/change logo (optional — only if file upload is available, otherwise skip)
4. Owner can delete organization (with confirmation dialog)
5. Non-owners see read-only view

#### Members List (`/org/members`)

1. Table showing members: avatar, name, email, role (owner/admin/member), join date
2. "Invite member" button opens invite modal
3. Owner/admin can change member roles via dropdown
4. Owner/admin can remove members (with confirmation)
5. Shows pending invitations section with status and option to revoke

#### Invite Members (Modal)

1. Dialog with email input + role selector (admin/member)
2. User enters email, selects role, clicks "Send invitation"
3. Loading state → success toast "Invitation sent to {email}"
4. Error handling: invalid email, user already a member, invitation already pending

### Edge cases

| Scenario | Page | Behavior |
|----------|------|----------|
| Duplicate email on register | Register | Inline error: "An account with this email already exists" |
| OAuth with existing email | Login | Account auto-linked if email is verified; error if not |
| Expired reset token | Reset Confirm | Error message + "Request a new reset link" button |
| Expired verification token | Verify Email | Error + "Resend verification email" button |
| Expired magic link | Login callback | Error page with option to request new magic link |
| Network error on form submit | All forms | Toast error: "Something went wrong. Please try again." |
| Session expired during org action | Org pages | Redirect to `/login` with return URL |
| User has no organizations | Org Switcher | Switcher shows "Create organization" only |
| Invite sent to existing member | Invite Modal | Error: "This user is already a member" |
| Last owner tries to leave org | Members List | Error: "Cannot remove the last owner" |
| Password too weak on register | Register | PasswordInput strength bar stays red, rules checklist shows unmet rules. Submit button enabled but server rejects |
| User hits back after successful login | Login | Already authenticated → redirect to `/` |
| Token missing from URL | Reset Confirm / Verify Email | Error: "Invalid link. Please request a new one." |

## Constraints

- **Better Auth client SDK**: All auth operations go through `authClient` from `better-auth/react`. No direct API calls.
- **Paraglide JS**: All user-facing strings must use `m.*` messages for i18n.
- **@repo/ui patterns**: New shared components follow shadcn/ui conventions (CVA, `cn()`, `React.ComponentProps`, `data-slot` attributes). See `docs/standards/frontend-patterns.mdx`.
- **TanStack Start**: Routes use `createFileRoute`. SSR-compatible (no `window` access at module level).
- **Existing components**: Must compose with existing `@repo/ui` components (Button, Card, Input, Label, Dialog, Select, etc.). Do not duplicate.
- **No backend changes**: All endpoints are available from #19. This is a frontend-only issue.
- **Worktree required**: Tier L — must use `git worktree add ../roxabi-68 -b feat/68-auth-ui-ux`.

## Non-goals

- Two-factor authentication (2FA/TOTP)
- Captcha/bot protection
- API keys / bearer tokens
- Passkeys (WebAuthn)
- SSO (SAML/OIDC enterprise)
- Phone/SMS authentication
- Rate limiting on auth endpoints (deferred to #53)
- Custom theme per organization
- Dark mode toggle (already exists in the app)
- Logo/image upload for organizations (deferred unless trivially simple)

## Technical Decisions

### 1. Toast Library: Sonner

**Decision:** Use [Sonner](https://sonner.emilkowal.ski/) for toast notifications.

- ~3KB, minimal API: `toast.success('Done')`, `toast.error('Failed')`
- Recommended by shadcn/ui documentation
- Add as a `Toaster` component in `@repo/ui`, render in root layout

### 2. PasswordInput Component (`@repo/ui`)

**Decision:** Build a `PasswordInput` primitive in the shared UI library.

- Eye icon toggle (show/hide password) using `lucide-react` icons
- Strength indicator: colored bar (4 segments) + rules checklist
- Strength rules: 8+ characters, uppercase, number, symbol
- Pure UI — no business logic, strength calculation via props or internal utility
- Follows CVA pattern with `data-strength` attribute for CSS targeting

### 3. OAuthButton Component (`@repo/ui`)

**Decision:** Build a generic `OAuthButton` primitive.

- Props: `provider: 'google' | 'github'`, standard button props
- Renders provider SVG icon + label
- Supports `loading` and `disabled` states
- No built-in click handler — consumer passes `onClick`

### 4. AuthLayout Component (`apps/web`)

**Decision:** App-specific layout component (not in `@repo/ui` — uses routing and i18n).

- Centered card on desktop, full-width on mobile
- App logo/branding at top
- Optional footer links (privacy, terms)
- Wraps all 6 auth pages for consistent layout

### 5. Remember Me: Session Duration

**Decision:** Default session 7 days, "Remember me" extends to 30 days.

- Login form includes a Checkbox labeled "Remember me"
- When checked, pass `rememberMe: true` to the auth client (or adjust session config)
- Better Auth supports `dontRememberMe` flag on `signIn.email()` — default is to remember. Invert: uncheck = `dontRememberMe: true`

### 6. Component Placement

| Component | Location | Reason |
|-----------|----------|--------|
| `OAuthButton` | `packages/ui/src/components/` | Generic primitive, no business logic |
| `PasswordInput` | `packages/ui/src/components/` | Generic primitive, no business logic |
| `Sonner` (Toaster) | `packages/ui/src/components/` | Generic primitive wrapper |
| `AuthLayout` | `apps/web/src/components/` | Uses app context (routing, i18n, branding) |
| `OrgSwitcher` | `apps/web/src/components/` | Uses auth client, app routing |
| Auth pages | `apps/web/src/routes/` | Route components |
| Org pages | `apps/web/src/routes/org/` | Route components |

### 7. Route Structure

| Route | File | Type |
|-------|------|------|
| `/login` | `routes/login.tsx` | Existing (modify) |
| `/register` | `routes/register.tsx` | Existing (modify) |
| `/reset-password` | `routes/reset-password.tsx` | Existing (modify) |
| `/reset-password/confirm` | `routes/reset-password/confirm.tsx` | New |
| `/verify-email` | `routes/verify-email.tsx` | New |
| `/magic-link-sent` | `routes/magic-link-sent.tsx` | New |
| `/org/settings` | `routes/org/settings.tsx` | New |
| `/org/members` | `routes/org/members.tsx` | New |

## Implementation Phases

### Phase 1: Shared Components

Install Sonner. Create `OAuthButton`, `PasswordInput`, and `Sonner` (Toaster wrapper) in `@repo/ui`. Export from `index.ts`. Add basic tests.

### Phase 2: AuthLayout + Auth Pages Polish

Create `AuthLayout` in `apps/web`. Refactor existing Login, Register, and Reset Request pages to use AuthLayout, OAuthButton, PasswordInput, inline validation, loading states, toast feedback, i18n strings, and responsive design.

### Phase 3: New Auth Pages

Build Reset Password Confirmation (`/reset-password/confirm`), Email Verification (`/verify-email`), and Magic Link Sent (`/magic-link-sent`) pages.

### Phase 4: Organization UI

Build OrgSwitcher component, integrate into Header. Create Org Settings page, Members List page, and Invite Members modal.

### Phase 5: Accessibility &amp; Testing

Audit all pages for accessibility (ARIA, keyboard, focus management). Write tests for new components and pages.

## Success Criteria

- [ ] Login page supports email/password + OAuth (Google, GitHub) + magic link with polished UI
- [ ] Register page has password strength indicator (bar + rules checklist) and inline validation
- [ ] Reset password flow works end-to-end: request → email → confirm → new password
- [ ] Email verification page reads token from URL and shows success/failure
- [ ] Magic link sent page shows confirmation with resend option
- [ ] "Remember me" checkbox on login (7-day default / 30-day extended session)
- [ ] Toast notifications (Sonner) for success/error on all form submissions
- [ ] OAuthButton component renders branded Google/GitHub buttons with icons
- [ ] PasswordInput component has show/hide toggle + strength bar + rules checklist
- [ ] AuthLayout provides consistent centered card layout across all auth pages
- [ ] All auth pages are responsive (mobile-first) and accessible (keyboard + screen reader)
- [ ] Org switcher in header shows user's organizations and allows switching
- [ ] Org settings page allows editing name/slug (owner only)
- [ ] Members list page shows members with roles, supports invite/remove/role change
- [ ] Invite members modal sends invitation with role selection
- [ ] All user-facing strings use Paraglide JS `m.*` messages
- [ ] All new components in `@repo/ui` have basic tests
- [ ] `bun lint &amp;&amp; bun typecheck &amp;&amp; bun run test` passes
- [ ] No regressions in existing auth functionality

## Open Questions

1. **Better Auth "Remember me" API**: The analysis assumes `dontRememberMe` flag exists on `signIn.email()`. Need to verify the exact client API during implementation. Fallback: skip "Remember me" if not supported cleanly.

2. **Org logo upload**: Listed as non-goal unless trivially simple. If Better Auth's org plugin supports a `logo` field natively and we can pass a URL, we could add a simple URL input. Otherwise, defer to a file upload issue.

3. **Auth redirect after login**: Should `/login` support a `?redirect=/some-page` query param to return users to their original destination? Likely yes, but implementation details TBD.

4. **Magic link callback route**: Better Auth handles the magic link callback internally. Need to verify if we need a dedicated callback route or if Better Auth redirects to `/` automatically after verification.

5. **Paraglide message keys**: Need to establish a naming convention for auth message keys (e.g., `auth.login.title`, `auth.register.passwordStrength.weak`). Should align with existing i18n patterns in the codebase.
