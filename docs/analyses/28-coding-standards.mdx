---
title: "Issue #28: Coding Standards & Best Practices Analysis"
description: Analysis of coding standards documentation needs for the Roxabi Boilerplate
---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.

## Executive Summary

This analysis evaluates what coding standards documentation is needed for the Roxabi Boilerplate, considering what already exists (CLAUDE.md, dev-process.md, contributing.mdx, Biome enforcement) versus what's missing. **The codebase already demonstrates strong patterns** — NestJS dependency injection, React hooks composition, strict TypeScript, structured error handling — but these patterns are only implicitly documented through code examples, not explicitly described as standards.

The recommended approach creates 4 focused documents in `docs/standards/` that codify existing patterns, fill gaps (TDD workflow, code review, testing patterns), and serve as actionable references for both human developers and AI agents.

## Current State Assessment

### What's Already Documented

| Topic | Location | Coverage |
|-------|----------|----------|
| File naming conventions | CLAUDE.md | Complete |
| Import organization | CLAUDE.md | Complete |
| Biome linting/formatting | biome.json (enforced) | Auto-enforced |
| TypeScript strict mode | tsconfig.json | Auto-enforced |
| Commit message format | contributing.mdx | Complete |
| Branch naming | contributing.mdx + dev-process.md | Complete |
| Development workflow | dev-process.md | Complete |
| Quality checklist | dev-process.md | Complete |
| PR guidelines | contributing.mdx | Complete |

### What's NOT Documented (Gaps)

| Topic | Priority | Notes |
|-------|----------|-------|
| SOLID principles in context | High | Patterns exist in code but undocumented |
| Design patterns catalog | High | DI, Factory, Interceptor, Hook — used but not described |
| Error handling strategy | High | AllExceptionsFilter + structured responses exist |
| Type safety best practices | High | Type guards, const assertions, generics in use |
| TDD workflow | High | No TDD documentation at all |
| Code review guidelines | Medium | PR checklist exists but no review standards |
| Testing patterns per layer | High | Tests exist but patterns not documented |
| Mocking strategies | Medium | Factory mock helpers used but not standardized |
| AI-assisted development | Medium | Claude Code hooks exist, no TDD workflow documented |

### Existing Code Patterns (Implicit Standards)

The codebase already follows strong patterns that should be codified:

**Backend (NestJS)**:
- Module-based organization with clear separation (common/, database/, config/)
- Dependency injection via providers with Symbol tokens (`DRIZZLE`, `POSTGRES_CLIENT`)
- Centralized error handling via `AllExceptionsFilter` with structured JSON responses
- Cross-cutting concerns via interceptors (`CorrelationIdInterceptor`)
- Environment validation with class-validator decorators
- Lifecycle management (`OnModuleDestroy` for cleanup)

**Frontend (React/TanStack)**:
- Feature-based organization with barrel exports
- Custom hooks for state/context management (`useTranslation`, `useLocale`)
- Functional components with variant props
- Error boundaries for graceful degradation
- Client/server utility separation

**TypeScript**:
- Const assertions with derived union types (`as const` + `typeof`)
- Type guard functions (`isValidLocale`)
- Generic types for API responses (`ApiResponse&lt;T>`)
- Mapped types for localization (`Record&lt;Locale, ...>`)
- `type` keyword imports enforced by Biome

**Testing**:
- Colocated test files (`.test.ts` next to source)
- Factory helper functions for mocks (`createMockHost`, `createMockContext`)
- Self-contained tests (no shared `beforeEach` state)
- Arrange-Act-Assert structure
- 70% coverage thresholds

---

## Option A: Minimal Documentation (Reference Cards)

### Description

Create 4 lightweight reference documents (&lt;100 lines each) that primarily link to existing documentation (CLAUDE.md, contributing.mdx) and add only the missing pieces. Minimal code examples, mostly bullet points and tables.

### Scope

- `coding-standards.mdx` — Summary table of conventions + links to CLAUDE.md
- `tdd-workflow.mdx` — Basic Red-Green-Refactor description
- `code-review.mdx` — Checklist format only
- `testing-patterns.mdx` — List of patterns without examples

### Pros
- Fast to create (~2 hours)
- Low maintenance burden
- No duplication with existing docs

### Cons
- Not actionable for new developers or AI agents
- Missing code examples = ambiguity
- Doesn't codify the implicit patterns already in the codebase
- Won't serve as an effective reference for code review

### Effort: ~2 hours | Quality: Low

---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.

## Option B: Comprehensive Standards Library

### Description

Create 4 in-depth documents (300-500 lines each) with full code examples, anti-patterns, decision trees, and enforcement guidelines. Include diagrams, comparison tables, and references to industry best practices.

### Scope

- `coding-standards.mdx` — Full SOLID walkthrough with project-specific examples, design pattern catalog, anti-patterns gallery, TypeScript advanced patterns
- `tdd-workflow.mdx` — Complete TDD guide with AI-assisted workflow, coverage strategy, mutation testing intro
- `code-review.mdx` — Detailed rubric with severity levels, automated checks, review workflow diagrams
- `testing-patterns.mdx` — Full testing pyramid, per-layer patterns with code examples, fixture/factory system, test data management

### Pros
- Comprehensive and authoritative
- Serves all audiences (new devs, AI agents, reviewers)
- Codifies all implicit patterns
- Reduces onboarding time significantly

### Cons
- High effort (~8-10 hours)
- Risk of over-documentation that becomes stale
- May duplicate Biome/TypeScript enforcement
- Some patterns may change as the project matures

### Effort: ~8-10 hours | Quality: High (but maintenance risk)

---

## Option C: Balanced Standards (Recommended)

### Description

Create 4 focused documents (150-250 lines each) that codify existing patterns with concrete code examples from the codebase, document the gaps (TDD, code review), and include actionable checklists. Avoid duplicating what Biome/TypeScript already enforce — reference those instead.

### Scope

#### 1. `coding-standards.mdx` (~200 lines)
- **SOLID in context**: One paragraph + one code example per principle, using actual project code
- **Design patterns catalog**: Table of patterns used (DI, Factory, Interceptor, Hook, Error Boundary) with file references
- **Code organization**: Module structure rules for backend and frontend
- **Error handling**: Document the existing `AllExceptionsFilter` pattern + frontend error boundaries
- **Type safety**: Document const assertions, type guards, generic patterns with examples
- **What Biome/TS enforce**: Short section listing auto-enforced rules (no need to repeat)

#### 2. `tdd-workflow.mdx` (~180 lines)
- **Red-Green-Refactor cycle**: Step-by-step with example
- **Test structure**: AAA pattern as practiced in the codebase
- **What to test**: Decision tree (unit vs integration vs E2E)
- **AI-assisted TDD**: Claude Code workflow for writing tests first
- **Coverage guidelines**: Explain the 70% threshold and exclusion patterns

#### 3. `code-review.mdx` (~150 lines)
- **Review checklist**: Categorized (correctness, security, performance, style)
- **Review criteria**: What to look for at each layer (frontend, backend, shared)
- **Feedback guidelines**: Constructive feedback format
- **Approval criteria**: When to approve, request changes, or block

#### 4. `testing-patterns.mdx` (~200 lines)
- **Frontend testing**: Vitest + Testing Library patterns with setup file reference
- **Backend testing**: NestJS filter/interceptor/provider test patterns (from existing tests)
- **E2E testing**: Playwright structure with Page Object pattern recommendation
- **Mock patterns**: Document factory helper approach with examples
- **Fixtures**: Strategy for test data management

### Pros
- Actionable and concrete — uses actual project code
- Fills real gaps without over-documenting
- Maintainable size (150-250 lines per doc)
- References auto-enforcement (Biome, TS) instead of duplicating
- Serves both human developers and AI agents

### Cons
- Medium effort (~4-5 hours)
- Some examples may need updating as code evolves
- Doesn't cover every edge case

### Effort: ~4-5 hours | Quality: Good (sustainable)

---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.

## Comparison

| Criteria | Option A | Option B | Option C |
|----------|----------|----------|----------|
| Effort | ~2h | ~8-10h | ~4-5h |
| Actionability | Low | High | High |
| Maintenance | Low | High | Medium |
| AI-agent usability | Low | High | High |
| Code examples | None | Extensive | Focused |
| Duplication risk | Low | High | Low |
| Onboarding value | Low | High | Good |

---

## Recommendation

**Option C (Balanced Standards)** is recommended. It:

1. **Codifies existing patterns** — The codebase already demonstrates strong conventions; these just need explicit documentation
2. **Fills real gaps** — TDD workflow and code review guidelines don't exist anywhere
3. **Is AI-agent friendly** — Concrete examples and checklists are directly usable by Claude Code
4. **Won't become stale** — References auto-enforcement tools instead of duplicating rules
5. **Matches project maturity** — The project is early-stage; over-documenting now risks documenting patterns that will change

### Implementation Plan

#### Files to Create

| File | Estimated Lines | Dependencies |
|------|----------------|-------------|
| `docs/standards/coding-standards.mdx` | ~200 | None |
| `docs/standards/tdd-workflow.mdx` | ~180 | None |
| `docs/standards/code-review.mdx` | ~150 | None |
| `docs/standards/testing-patterns.mdx` | ~200 | None |
| `docs/standards/meta.json` | ~10 | None |

#### Files to Update

| File | Change |
|------|--------|
| `docs/meta.json` | Add `standards` section to navigation |
| `CLAUDE.md` | Reference new standards documents |

#### Tier Assessment

**Tier M** — 7 files total (5 new + 2 updates), documentation-only (no regression risk), local architecture impact.

#### Key Principles for Writing

1. **Use actual project code** — Every example should reference real files
2. **Don't repeat Biome** — Link to `biome.json` for formatting/linting rules
3. **Don't repeat CLAUDE.md** — Link for file naming and import conventions
4. **Be prescriptive** — "Do X" not "Consider X"
5. **Include anti-patterns** — Show what NOT to do alongside what to do
6. **Keep it scannable** — Tables, checklists, and code blocks over prose

### Key Sources for Content

| Source | What to Extract |
|--------|----------------|
| `apps/api/src/common/` | Error handling, interceptor, filter patterns |
| `apps/api/src/database/` | DI, provider, lifecycle patterns |
| `apps/api/src/config/` | Validation, environment config patterns |
| `apps/web/src/lib/i18n/` | Module organization, hooks, type safety |
| `apps/web/src/components/` | Component patterns, error boundaries |
| `packages/types/src/` | Shared type patterns, generics |
| `vitest.config.ts` + `vitest.shared.ts` | Test config, coverage thresholds |
| `apps/api/src/common/filters/all-exceptions.filter.test.ts` | Backend test pattern |
| `apps/web/src/lib/i18n/__tests__/server.test.ts` | Frontend test pattern |

---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.

## Challenge Review (Post-Analysis)

After the initial spec was written based on Option C, a systematic challenge review was conducted against 2025-2026 best practices. Seven parallel research agents validated every pattern in the spec against current industry standards, NestJS/React/TypeScript ecosystems, and the actual codebase.

**Result**: 17 items were identified and resolved. See the [updated spec](/docs/specs/28-coding-standards#challenge-review-decisions) for the full decision table.

**Key changes from the original analysis**:
- Document count changed from 4 (analysis) → 5 (initial spec) → 4 + AI file (post-challenge)
- TDD workflow and testing patterns merged into single document (overlap identified)
- Several patterns corrected against current best practices (barrel exports, exception strategy, correlation ID placement, React Compiler, Conventional Comments)
- Coverage threshold raised from 70% to 80% with ratcheting
- Security section significantly expanded
- AI-agent consumability addressed via separate `.claude/processes/coding-standards.md` file
