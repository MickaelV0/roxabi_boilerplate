---
title: "Issue #8: CI/CD GitHub Actions - Technical Analysis"
description: Technical analysis for Roxabi Boilerplate infrastructure
---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.


**Issue**: Setup: CI/CD GitHub Actions
**Size**: M (Medium) | **Priority**: P1 (Critical)
**Blocked by**: #9 (Testing), #10 (Git hooks)
**Date**: 2026-02-02

---

## Executive Summary

GitHub Actions provides the most integrated CI/CD solution for this Bun/TurboRepo monorepo, with native support for Bun via `oven-sh/setup-bun` and excellent TurboRepo caching options. The recommended approach combines TurboRepo's `--affected` flag for smart change detection, GitHub Actions caching for dependencies, and a modular workflow structure that separates CI (quality gates) from CD (deployment). This setup can achieve 2x faster CI times compared to traditional npm/yarn setups while maintaining comprehensive quality checks.

---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.

## State of the Art (2025-2026)

### Bun in CI/CD

The official `oven-sh/setup-bun` action is now mature and production-ready. Key characteristics:
- **Speed**: Bun's package installation is significantly faster than npm/yarn (reported 2x CI speedup)
- **Caching**: Built-in lockfile caching support via `bun.lockb`
- **Compatibility**: Full support for running Vitest, TypeScript compilation, and build tools

### TurboRepo Remote Caching

Three main caching strategies have emerged:
1. **Vercel Remote Cache** (Official): Requires Vercel account, uses `TURBO_TOKEN` and `TURBO_TEAM`
2. **GitHub Actions Cache** via `rharkor/caching-for-turbo`: No Vercel dependency, uses GitHub's built-in cache
3. **Self-hosted S3 Cache**: For enterprises requiring data sovereignty

The `--affected` flag is now the recommended approach for PR workflows, automatically detecting changed packages using `GITHUB_BASE_REF`.

### Biome CI Integration

Biome offers dedicated CI support via `biomejs/setup-biome@v2`:
- The `biome ci` command (vs `biome check`) is specifically designed for CI environments
- Produces GitHub annotations for inline PR feedback
- Single binary, extremely fast execution

### Vitest Coverage Reporting

The `davelosert/vitest-coverage-report-action` is the de facto standard:
- Posts coverage summary as PR comments
- Supports coverage thresholds to block PRs
- Auto-updates comments to avoid spam
- Requires `json-summary` reporter in Vitest config

### GitHub Actions 2026 Features

Upcoming features relevant to this project:
- **Parallel steps** (expected mid-2026): Run steps within a job concurrently
- **Timezone support** for scheduled jobs
- **Improved matrix builds**: Dynamic matrix generation based on changed files

### Deployment Platforms

Platform recommendations for this stack:
| Component | Recommended Platform | Alternative |
|-----------|---------------------|-------------|
| Frontend (TanStack Start) | Vercel, Cloudflare Workers | Railway |
| Backend (NestJS/Fastify) | Railway, Fly.io | Render |
| Database | Railway, Supabase | PlanetScale |

---

## Option A: MVP Approach (Fastest to Implement)

### Description

Single workflow file with sequential jobs. Uses basic GitHub Actions caching without TurboRepo remote cache. Minimal configuration, gets CI running quickly.

### Implementation

**`.github/workflows/ci.yml`**
```yaml
name: CI

on:
  pull_request:
    branches: [main]
  push:
    branches: [main]

jobs:
  ci:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest

      - name: Cache dependencies
        uses: actions/cache@v4
        with:
          path: ~/.bun/install/cache
          key: ${{ runner.os }}-bun-${{ hashFiles('**/bun.lockb') }}
          restore-keys: ${{ runner.os }}-bun-

      - run: bun install --frozen-lockfile

      - name: Lint
        run: bun run lint

      - name: TypeCheck
        run: bun run typecheck

      - name: Test
        run: bun run test

      - name: Build
        run: bun run build
```

**`.github/workflows/cd.yml`**
```yaml
name: CD

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2

      - run: bun install --frozen-lockfile
      - run: bun run build

      # Deploy steps (platform-specific)
```

### Pros

- Quick to set up (< 1 hour)
- Easy to understand and debug
- No external dependencies (Vercel account, etc.)
- Sufficient for small teams/early stages

### Cons

- No parallelization (longer CI times)
- No TurboRepo cache sharing between runs
- No coverage reporting
- Rebuilds all packages on every PR
- No deployment notifications

### Estimated Complexity: 1/5

---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.

## Option B: Gold Standard (Best Quality)

### Description

Full-featured CI/CD with parallel jobs, TurboRepo remote caching, matrix builds for cross-platform testing, comprehensive coverage reporting, environment-based deployments, and security hardening.

### Implementation

**`.github/workflows/ci.yml`**
```yaml
name: CI

on:
  pull_request:
    branches: [main]
  push:
    branches: [main]

permissions:
  contents: read
  pull-requests: write
  id-token: write  # For OIDC

env:
  TURBO_TOKEN: ${{ secrets.TURBO_TOKEN }}
  TURBO_TEAM: ${{ vars.TURBO_TEAM }}

jobs:
  # Determine affected packages
  changes:
    runs-on: ubuntu-latest
    outputs:
      packages: ${{ steps.filter.outputs.packages }}
      has-changes: ${{ steps.filter.outputs.has-changes }}
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - uses: oven-sh/setup-bun@v2

      - name: Detect changes
        id: filter
        run: |
          PACKAGES=$(bunx turbo run build --dry-run=json --filter='...[origin/main]' | jq -c '.packages')
          echo "packages=$PACKAGES" >> $GITHUB_OUTPUT
          echo "has-changes=$([[ "$PACKAGES" != "[]" ]] && echo true || echo false)" >> $GITHUB_OUTPUT

  lint:
    needs: changes
    if: needs.changes.outputs.has-changes == 'true'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: biomejs/setup-biome@v2

      - name: Run Biome
        run: biome ci .

  typecheck:
    needs: changes
    if: needs.changes.outputs.has-changes == 'true'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2

      - uses: rharkor/caching-for-turbo@v1

      - run: bun install --frozen-lockfile

      - run: bun run typecheck --affected

  test:
    needs: changes
    if: needs.changes.outputs.has-changes == 'true'
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        os: [ubuntu-latest]
        # Extend for cross-platform: [ubuntu-latest, windows-latest, macos-latest]
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2

      - uses: rharkor/caching-for-turbo@v1

      - run: bun install --frozen-lockfile

      - name: Run tests with coverage
        run: bun run test --coverage --coverage.reporter=json-summary --coverage.reporter=json

      - name: Coverage Report
        if: github.event_name == 'pull_request'
        uses: davelosert/vitest-coverage-report-action@v2
        with:
          json-summary-path: ./coverage/coverage-summary.json
          json-final-path: ./coverage/coverage-final.json

  build:
    needs: [lint, typecheck, test]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2

      - uses: rharkor/caching-for-turbo@v1

      - run: bun install --frozen-lockfile

      - run: bun run build --affected

      - name: Upload build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: build-artifacts
          path: |
            apps/*/dist
            apps/*/.output

  # Security scan
  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Run security audit
        run: bun audit

      - name: CodeQL Analysis
        uses: github/codeql-action/analyze@v3

  # Summary job for branch protection
  ci-success:
    needs: [build, security]
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: Check all jobs passed
        run: |
          if [[ "${{ needs.build.result }}" != "success" ]] || \
             [[ "${{ needs.security.result }}" != "success" ]]; then
            exit 1
          fi
```

**`.github/workflows/cd.yml`**
```yaml
name: CD

on:
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: read
  id-token: write

jobs:
  deploy-web:
    runs-on: ubuntu-latest
    environment: production
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2

      - run: bun install --frozen-lockfile
      - run: bun run build --filter=web

      # Vercel deployment (OIDC preferred)
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          vercel-args: '--prod'

  deploy-api:
    runs-on: ubuntu-latest
    environment: production
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2

      - run: bun install --frozen-lockfile
      - run: bun run build --filter=api

      # Railway deployment
      - name: Deploy to Railway
        uses: bervProject/railway-deploy@main
        with:
          railway_token: ${{ secrets.RAILWAY_TOKEN }}
          service: api

  notify:
    needs: [deploy-web, deploy-api]
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: Slack Notification
        uses: 8398a7/action-slack@v3
        with:
          status: ${{ job.status }}
          fields: repo,message,commit,author
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}
```

### Pros

- Maximum performance with parallel jobs
- TurboRepo remote caching for fast rebuilds
- Coverage reports on every PR
- Security scanning (audit + CodeQL)
- OIDC-ready for cloud deployments
- Environment-based deployment protection
- Deployment notifications
- Smart affected-only builds

### Cons

- Complex initial setup (8+ hours)
- Requires Vercel account for TurboRepo cache (or use GitHub cache alternative)
- More secrets to manage
- Steeper learning curve for team
- May be overkill for small projects

### Estimated Complexity: 5/5

---

## Option C: Balanced Approach (Recommended)

### Description

Pragmatic middle ground with parallel CI jobs, GitHub Actions-based TurboRepo caching (no Vercel dependency), coverage reporting, and straightforward CD. Uses reusable workflow patterns for maintainability.

### Implementation

**`.github/workflows/ci.yml`**
```yaml
name: CI

on:
  pull_request:
    branches: [main]
  push:
    branches: [main]

permissions:
  contents: read
  pull-requests: write

jobs:
  lint:
    name: Lint
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: biomejs/setup-biome@v2
        with:
          version: latest

      - name: Run Biome CI
        run: biome ci .

  typecheck:
    name: TypeCheck
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest

      - name: Cache Bun dependencies
        uses: actions/cache@v4
        with:
          path: ~/.bun/install/cache
          key: ${{ runner.os }}-bun-${{ hashFiles('**/bun.lockb') }}
          restore-keys: ${{ runner.os }}-bun-

      - name: Setup TurboRepo cache
        uses: rharkor/caching-for-turbo@v1

      - run: bun install --frozen-lockfile

      - run: bun run typecheck

  test:
    name: Test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest

      - name: Cache Bun dependencies
        uses: actions/cache@v4
        with:
          path: ~/.bun/install/cache
          key: ${{ runner.os }}-bun-${{ hashFiles('**/bun.lockb') }}
          restore-keys: ${{ runner.os }}-bun-

      - name: Setup TurboRepo cache
        uses: rharkor/caching-for-turbo@v1

      - run: bun install --frozen-lockfile

      - name: Run tests with coverage
        run: bun run test -- --coverage --reporter=json-summary --reporter=json

      - name: Coverage Report
        if: github.event_name == 'pull_request'
        uses: davelosert/vitest-coverage-report-action@v2
        with:
          json-summary-path: ./coverage/coverage-summary.json
          json-final-path: ./coverage/coverage-final.json
          vite-config-path: ./vitest.config.ts

  build:
    name: Build
    needs: [lint, typecheck, test]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest

      - name: Cache Bun dependencies
        uses: actions/cache@v4
        with:
          path: ~/.bun/install/cache
          key: ${{ runner.os }}-bun-${{ hashFiles('**/bun.lockb') }}
          restore-keys: ${{ runner.os }}-bun-

      - name: Setup TurboRepo cache
        uses: rharkor/caching-for-turbo@v1

      - run: bun install --frozen-lockfile

      - name: Build all packages
        run: bun run build

      - name: Upload build artifacts
        uses: actions/upload-artifact@v4
        with:
          name: build-output
          path: |
            apps/*/dist
            apps/*/.output
          retention-days: 7
```

**`.github/workflows/cd.yml`**
```yaml
name: CD

on:
  push:
    branches: [main]
  workflow_dispatch:
    inputs:
      environment:
        description: 'Deployment environment'
        required: true
        default: 'production'
        type: choice
        options:
          - staging
          - production

concurrency:
  group: deploy-${{ github.ref }}
  cancel-in-progress: false

jobs:
  build:
    name: Build for Deployment
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest

      - name: Cache Bun dependencies
        uses: actions/cache@v4
        with:
          path: ~/.bun/install/cache
          key: ${{ runner.os }}-bun-${{ hashFiles('**/bun.lockb') }}
          restore-keys: ${{ runner.os }}-bun-

      - name: Setup TurboRepo cache
        uses: rharkor/caching-for-turbo@v1

      - run: bun install --frozen-lockfile
      - run: bun run build

      - name: Upload web build
        uses: actions/upload-artifact@v4
        with:
          name: web-build
          path: apps/web/.output

      - name: Upload api build
        uses: actions/upload-artifact@v4
        with:
          name: api-build
          path: apps/api/dist

  deploy-web:
    name: Deploy Web
    needs: build
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment || 'production' }}
    steps:
      - uses: actions/checkout@v4

      - uses: actions/download-artifact@v4
        with:
          name: web-build
          path: apps/web/.output

      # Option 1: Vercel
      - name: Deploy to Vercel
        if: vars.DEPLOY_PLATFORM == 'vercel'
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID_WEB }}
          vercel-args: '--prod'

      # Option 2: Cloudflare Pages
      # - name: Deploy to Cloudflare
      #   uses: cloudflare/pages-action@v1
      #   with:
      #     apiToken: ${{ secrets.CLOUDFLARE_API_TOKEN }}
      #     accountId: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
      #     projectName: roxabi-web
      #     directory: apps/web/.output/public

  deploy-api:
    name: Deploy API
    needs: build
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment || 'production' }}
    steps:
      - uses: actions/checkout@v4

      - uses: actions/download-artifact@v4
        with:
          name: api-build
          path: apps/api/dist

      # Option 1: Railway
      - name: Deploy to Railway
        if: vars.DEPLOY_PLATFORM == 'railway'
        uses: bervProject/railway-deploy@main
        with:
          railway_token: ${{ secrets.RAILWAY_TOKEN }}
          service: api

      # Option 2: Fly.io
      # - name: Deploy to Fly.io
      #   uses: superfly/flyctl-actions/setup-flyctl@master
      # - run: flyctl deploy --remote-only
      #   env:
      #     FLY_API_TOKEN: ${{ secrets.FLY_API_TOKEN }}

  notify:
    name: Notify
    needs: [deploy-web, deploy-api]
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: Deployment Status
        uses: actions/github-script@v7
        with:
          script: |
            const web = '${{ needs.deploy-web.result }}';
            const api = '${{ needs.deploy-api.result }}';
            const status = (web === 'success' && api === 'success') ? 'success' : 'failure';

            console.log(`Deployment completed: Web=${web}, API=${api}`);

            // Add Slack/Discord notification here if needed
```

### Pros

- Parallel jobs for fast CI (~3-4 min typical)
- TurboRepo caching without Vercel dependency
- Coverage reports on PRs
- Manual deployment trigger option
- Environment-based deployments
- Concurrency control (prevents duplicate deploys)
- Clear job separation for easy debugging
- Reasonable setup time (2-4 hours)

### Cons

- No affected-only filtering (full rebuild)
- No cross-platform testing matrix
- No security scanning (add later)
- Manual notification setup required

### Estimated Complexity: 3/5

---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.

## Comparison Table

| Aspect | Option A (MVP) | Option B (Gold) | Option C (Balanced) |
|--------|----------------|-----------------|---------------------|
| **Setup Time** | < 1 hour | 8+ hours | 2-4 hours |
| **CI Speed** | Slow (sequential) | Fast (parallel + cache) | Fast (parallel + cache) |
| **Quality Gates** | Basic | Comprehensive | Good |
| **Coverage Reports** | No | Yes | Yes |
| **TurboRepo Cache** | Local only | Vercel remote | GitHub Actions |
| **Security Scanning** | No | Yes | No (add later) |
| **Affected-only Builds** | No | Yes | No |
| **Deployment Flexibility** | Basic | Full | Good |
| **Notifications** | No | Yes | Optional |
| **Maintenance** | Low | High | Medium |
| **Complexity** | 1/5 | 5/5 | 3/5 |

### Quick Reference

| Criteria | A | B | C |
|----------|---|---|---|
| Speed to implement | 5 | 1 | 3 |
| Quality/features | 2 | 5 | 4 |
| Complexity | 1 | 5 | 3 |
| Maintenance burden | 1 | 4 | 2 |

---

## Recommendation

**Recommended: Option C (Balanced Approach)**

### Justification

1. **Right-sized for Current Stage**: This is a boilerplate project setting foundations. Option C provides solid CI/CD without over-engineering.

2. **No External Dependencies**: Using `rharkor/caching-for-turbo` avoids requiring a Vercel account, reducing setup friction and keeping costs at $0.

3. **Parallel Jobs Matter**: The difference between sequential (Option A) and parallel execution is significant - expect 3-4 minute CI runs vs 8-10 minutes.

4. **Coverage Reports are Essential**: PR coverage comments from `davelosert/vitest-coverage-report-action` provide immediate feedback without additional tooling.

5. **Upgrade Path Clear**: Option C can be incrementally upgraded to Option B features:
   - Add `--affected` filtering when repo grows
   - Add security scanning when needed
   - Switch to OIDC authentication later

6. **Team Scalability**: Medium complexity is manageable for small teams while not creating technical debt.

### Implementation Priority

1. **Week 1**: Set up CI workflow with lint, typecheck, test, build
2. **Week 2**: Add CD workflow with chosen platform (Railway/Vercel)
3. **Week 3**: Add coverage reporting and notifications
4. **Future**: Iterate based on actual pain points

### Prerequisites (Issues #9, #10)

Before implementing:
- **Issue #9 (Testing)**: Vitest must be configured with coverage reporters
- **Issue #10 (Git hooks)**: Pre-commit hooks should catch issues before CI

---

> **Deprecated**: This document is outdated and kept for historical reference only. Please refer to the main documentation sections for current information.

## Key Resources

### Official Documentation

- [Bun CI/CD Guide](https://bun.com/docs/guides/runtime/cicd)
- [setup-bun GitHub Action](https://github.com/oven-sh/setup-bun)
- [TurboRepo GitHub Actions Guide](https://turborepo.dev/docs/guides/ci-vendors/github-actions)
- [TurboRepo CI Construction](https://turborepo.dev/docs/crafting-your-repository/constructing-ci)
- [Biome CI Setup](https://biomejs.dev/recipes/continuous-integration/)
- [setup-biome GitHub Action](https://github.com/biomejs/setup-biome)

### Caching Solutions

- [caching-for-turbo Action](https://github.com/rharkor/caching-for-turbo) - Recommended
- [GitHub Actions Cache](https://github.com/actions/cache)
- [Vercel Remote Cache Setup](https://turborepo.dev/docs/guides/ci-vendors/github-actions#remote-caching)

### Coverage Reporting

- [vitest-coverage-report-action](https://github.com/davelosert/vitest-coverage-report-action)
- [Vitest Coverage Setup Guide](https://medium.com/@alvarado.david/vitest-code-coverage-with-github-actions-report-compare-and-block-prs-on-low-coverage-67fceaa79a47)

### Deployment Platforms

- [Vercel GitHub Actions](https://dev.to/ephraimx/a-practical-guide-to-deploying-frontend-apps-on-vercel-using-github-actions-3pf4)
- [Railway Deployment Guide](https://docs.railway.com/guides/github-autodeploys)
- [Fly.io Continuous Deployment](https://fly.io/docs/launch/continuous-deployment-with-github-actions/)
- [TanStack Start on Cloudflare](https://developers.cloudflare.com/workers/framework-guides/web-apps/tanstack-start/)

### Security Best Practices

- [GitHub Actions Security Hardening](https://docs.github.com/en/actions/reference/security/secure-use)
- [OIDC in GitHub Actions](https://docs.github.com/en/actions/concepts/security/openid-connect)
- [Secrets Best Practices](https://www.blacksmith.sh/blog/best-practices-for-managing-secrets-in-github-actions)

### Monorepo CI/CD Guides

- [GitHub Actions Monorepo Guide 2026](https://dev.to/pockit_tools/github-actions-in-2026-the-complete-guide-to-monorepo-cicd-and-self-hosted-runners-1jop)
- [Monorepo with GitHub Actions](https://graphite.com/guides/monorepo-with-github-actions)
- [Reusable Workflows vs Composite Actions](https://dev.to/n3wt0n/composite-actions-vs-reusable-workflows-what-is-the-difference-github-actions-11kd)

### Platform Comparisons

- [Deployment Platforms 2025 Comparison](https://www.jasonsy.dev/blog/comparing-deployment-platforms-2025)
- [Deploying Full Stack Apps 2026](https://www.nucamp.co/blog/deploying-full-stack-apps-in-2026-vercel-netlify-railway-and-cloud-options)

---

## Appendix: Secrets Required

### CI (Option C)

No secrets required for basic CI.

### CD (Option C)

| Secret | Required For | Where to Get |
|--------|--------------|--------------|
| `VERCEL_TOKEN` | Vercel deploy | Vercel Dashboard > Settings > Tokens |
| `VERCEL_ORG_ID` | Vercel deploy | Project Settings > General |
| `VERCEL_PROJECT_ID_WEB` | Vercel deploy | Project Settings > General |
| `RAILWAY_TOKEN` | Railway deploy | Railway Dashboard > Account > Tokens |
| `FLY_API_TOKEN` | Fly.io deploy | `flyctl tokens create deploy` |

### Repository Variables (not secrets)

| Variable | Purpose |
|----------|---------|
| `DEPLOY_PLATFORM` | Switch between deployment targets |
