---
title: "Skill Graph Architecture — Light Adoption"
description: Analysis of approaches to add skill-to-skill metadata and a workflow guide to the Roxabi boilerplate's 15 skills.
---

**Issue:** #284 | **Tier:** F-full (user override from S) | **Status:** Draft | **Dependencies:** None

## Context

The Roxabi boilerplate has 15 skills and a multi-stage pipeline (`bootstrap → scaffold → review → promote → cleanup`). Seven orchestration skills already reference each other through text-based handoffs — for example, bootstrap ends with "Run `/scaffold --spec N`" and scaffold suggests `/bootstrap` when no spec is found.

Investigation during the parent issue (#251) found:
- 7 skills reference others via text-based handoffs
- 4 skills call the `issue-triage` CLI directly
- No programmatic skill-to-skill invocation beyond `bootstrap → interview`
- No evidence of agents failing to find the right skill today

This phase was triggered by pattern #16 from the SpecForge evaluation: **semantic anchors in skill headers**. The original recommendation was light adoption — metadata + docs, no forced chaining.

**Parent issue:** #251 (AI Workflow Improvement Strategy)
**Parent spec:** [251-ai-workflow-improvement-strategy.mdx](../specs/251-ai-workflow-improvement-strategy.mdx)

## Questions Explored

1. What value does skill graph metadata provide when current text handoffs already work?
2. What format should the metadata take — docs only, per-skill frontmatter, or a central registry?
3. What should the workflow guide contain — happy path only, or full tier variations with error recovery?

## Analysis

### Current State

The 7 orchestration skills and their existing handoffs:

| From | To | Handoff Text | Location |
|------|----|-------------|----------|
| bootstrap | scaffold | "Run `/scaffold --spec N` to execute" | Completion message |
| bootstrap | review/scaffold | "AskUserQuestion: `/review` \| `/scaffold`" | Pre-check (existing PR) |
| scaffold | bootstrap | "suggest `/bootstrap`. Stop." | Spec not found |
| scaffold | review/1b1 | "Next: /review → /1b1 → fixer → merge" | Summary output |
| review | 1b1 | "walks the human through findings using `/1b1`" | Post-review phase |
| 1b1 | review | "Review findings (from `/review`)" | Input description |
| issues | issue-triage | "suggest `/issue-triage`" | Missing triage data |

Additionally, 4 skills invoke the `issue-triage` CLI directly (`bun .claude/skills/issue-triage/triage.ts`): bootstrap (status transitions), scaffold (status transitions), pr (status update), and issue-triage itself (primary interface). These are programmatic invocations, not text handoffs, and are out of scope for this analysis.

These handoffs work but are inconsistent in format, scattered across files, and invisible to new sessions unless the agent reads each SKILL.md.

### Value Proposition

The current system functions. The value of adding metadata and a workflow guide is threefold:

1. **Faster onboarding**: A fresh agent session (or a new developer) can read one workflow guide and understand the full pipeline — which skills exist, in what order, and with what conditions. Today this requires reading 7 separate SKILL.md files.

2. **Better documentation**: A single source of truth for skill relationships, including tier-specific paths (S skips bootstrap, F-full uses the full pipeline) and error recovery (what to do when scaffold fails mid-way).

3. **Future extensibility**: Machine-readable frontmatter enables future automation — a hook that auto-suggests the next skill, a validation step that checks skill ordering, or a dashboard that visualizes the pipeline.

### Frontmatter Schema

The proposed `next-skills` field format for skill YAML frontmatter:

```yaml
# Added to existing frontmatter in each orchestration skill
next-skills:
  - skill: scaffold
    condition: "when spec is approved"
  - skill: review
    condition: "when existing PR found"
suggested-before: [bootstrap]          # skills that typically precede this one
workflow-phase: planning                # planning | implementation | review | release | cleanup
```

Fields are optional and advisory. Nothing reads them programmatically today — they serve as structured documentation that can be parsed later.

**Design question:** `next-skills` on skill A and `suggested-before` on skill B encode the same relationship bidirectionally. The spec should decide whether to maintain both directions (more discoverable, higher drift risk) or use only `next-skills` (unidirectional, simpler).

### Workflow Guide Depth

The workflow guide (`docs/guides/skill-workflows.mdx`) will include:

- **Full pipeline flow**: Mermaid diagram showing the complete `bootstrap → scaffold → review → promote → cleanup` chain
- **Per-tier paths**: How S, F-lite, and F-full differ (S skips bootstrap, F-lite may skip review, F-full uses all stages)
- **Error recovery**: What to do when scaffold fails mid-way, when review finds blockers, when promote pre-flight fails
- **Decision points**: When to use `/bootstrap --spec` vs `--issue`, when to skip to `/scaffold`, etc.
- **Skill reference table**: All 15 skills with one-line descriptions and workflow phase

**Overlap note:** `docs/guides/agent-teams.mdx` already describes the pipeline from an agent coordination perspective. The workflow guide focuses on skill sequencing — complementary, not duplicative. The spec should define the boundary clearly.

## Shapes

### Shape A: Docs-first

- **Description:** Create only the workflow guide (`docs/guides/skill-workflows.mdx`) with Mermaid diagrams. No changes to skill files.
- **Trade-offs:**
  - Pro: Fastest to implement (1 file). No risk of frontmatter drift.
  - Con: Not machine-readable. No future automation path without adding metadata later. Workflow guide can drift from actual skill behavior.
- **Rough scope:** 1 new file, ~2 hours.

### Shape B: Frontmatter + docs

- **Description:** Add `next-skills`, `suggested-before`, and `workflow-phase` to 7 orchestration skill frontmatters. Create the workflow guide that references this metadata. Update 5 inconsistent text handoffs to use standard invocation syntax.
- **Trade-offs:**
  - Pro: Machine-readable metadata enables future automation. Docs and data coexist. Handoffs become consistent.
  - Con: 8+ files to modify. Frontmatter schema not validated (could go stale if skills evolve without updating metadata).
  - Mitigation: Frontmatter is optional/advisory — stale metadata is low-risk since nothing depends on it programmatically.
- **Rough scope:** 7 SKILL.md edits, 1 new doc, ~5 text handoff updates. Half-day to full day.

### Shape C: Registry + docs

- **Description:** Create a central `.claude/skill-registry.yaml` mapping all skill connections. Skills themselves remain unchanged. Workflow guide references the registry.
- **Trade-offs:**
  - Pro: Single file to maintain. Easy to lint/validate. Clean separation of concerns.
  - Con: New abstraction layer for just 7 skills — over-engineered. Registry and skills live in different files, creating drift risk. Adds a concept that doesn't exist in the Claude Code ecosystem.
- **Rough scope:** 1 new registry file, 1 new doc. Half-day.

## Fit Check

| Requirement | Shape A (Docs-first) | Shape B (Frontmatter + docs) | Shape C (Registry + docs) |
|-------------|----------------------|------------------------------|---------------------------|
| Faster onboarding | ✅ | ✅ | ✅ |
| Better documentation | ✅ | ✅ | ✅ |
| Future extensibility | ❌ | ✅ | ✅ |
| Light adoption (no model changes) | ✅ | ✅ | ✅ |
| No new abstractions | ✅ | ✅ | ❌ |
| Consistent handoff format | ❌ | ✅ | ❌ |
| Low drift risk | ✅ | ✅ | ❌ |

**Selected shape:** Shape B (Frontmatter + docs) — balances documentation value with future extensibility while staying light. The frontmatter is additive to existing skill files and doesn't introduce new concepts.

## Conclusions

- **No current pain:** Text handoffs work. This is a documentation and extensibility investment.
- **Shape B is the right balance:** Metadata in each skill's frontmatter keeps the source of truth co-located with the skill definition. A central registry (Shape C) adds unnecessary abstraction for 7 skills.
- **Workflow guide is the primary deliverable:** The Mermaid-based guide with tier variations and error recovery paths is where most of the onboarding value lives.
- **Semantic anchors deferred:** The parent spec (#251, line 237) lists semantic anchors as part of Phase 5 scope. This analysis defers them because: (a) the user requested brainstorming from scratch on their value, (b) semantic anchors (methodology terms like "Shape Up", "INVEST") are a separate concern from skill-to-skill wiring, and (c) they can be added as a small follow-up without affecting the graph metadata or workflow guide.
- **Handoff consistency matters:** Updating 5 scattered handoff texts to use a consistent format (explicit `/skill-name` invocation syntax) is a low-effort, high-clarity improvement.

## Next Steps

- Promote to spec: define exact frontmatter for each of the 7 skills, workflow guide structure, and which 5 handoffs to update
- Create spec at `artifacts/specs/284-skill-graph-architecture.mdx`
