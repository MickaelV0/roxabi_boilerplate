---
title: "System Settings Admin Page + Backend"
parent_spec: "artifacts/specs/270-admin-phase3-system-settings-feature-flags.mdx"
parent_issue: 270
---

## Scope

Slice V2: Settings admin controller, frontend page, audit logging, sidebar enablement.

- `AdminSettingsController` (`GET /api/admin/settings`, `PATCH /api/admin/settings`)
- Frontend `/admin/system-settings` page with category cards and per-card save
- `settings-card.tsx` component (type-appropriate inputs: text, number, boolean toggle, select)
- Batch settings update with transaction + post-commit audit logging
- Audit logging (`settings.updated` action, `resourceId = setting key`)
- Enable "System Settings" sidebar nav item
- Route guard: `staticData: { permission: 'role:superadmin' }` + `beforeLoad: enforceRoutePermission`
- Exception types: `SettingNotFoundException`, `SettingValidationException`

## Success Criteria

- [ ] `GET /api/admin/settings` returns all 12 seeded settings grouped by category. Non-superadmin returns 403
- [ ] `PATCH /api/admin/settings` with `{ updates: [{ key: "app.name", value: "NewName" }] }` updates the setting with audit log
- [ ] `PATCH /api/admin/settings` with invalid type (e.g., string value for number setting) returns 400
- [ ] `/admin/system-settings` page displays settings in category cards with correct input types
- [ ] Per-card save works with success toast
- [ ] "System Settings" sidebar nav item enabled and visible to super admins only
- [ ] All endpoints use `@Roles('superadmin')` with `@SkipOrg()`
- [ ] Audit log entries created with `resourceId = setting key` and before/after values

## Reference

Full spec: [artifacts/specs/270-admin-phase3-system-settings-feature-flags.mdx](./270-admin-phase3-system-settings-feature-flags.mdx)
