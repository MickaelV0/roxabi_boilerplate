---
title: "Dev Process Overhaul"
description: Rewrite the Tier F development workflow with clear roles, multi-domain review, test-first ordering, and a fullstack quick fixer agent.
status: implemented
---

## Context

The [process retrospective](../analyses/process-retrospective-2026-02-12.mdx) identified
several gaps in the current development workflow: conflicting test ordering between
`dev-process.mdx` and `testing.mdx`, unclear role boundaries between the human lead,
Main Claude (orchestrator), and the product-lead agent, a single "reviewer" agent that
tries to cover all domains, and a rigid file-count-based tier classification.

This spec rewrites the Tier F workflow end-to-end and updates all supporting documentation.

**Promoted from:** [Process Retrospective](../analyses/process-retrospective-2026-02-12.mdx)

## Goal

Deliver a clear, end-to-end development workflow where:

1. Roles are unambiguous (human decides, Main Claude orchestrates, agents specialize)
2. Review quality improves via fresh multi-domain agents instead of a single reviewer
3. Test-first ordering is the default for code changes
4. Tier F has two tracks (F-lite / F-full) based on judgment, not file count
5. A fullstack quick fixer replaces the current reviewer agent for post-review fixes

## Users &amp; Use Cases

| Actor | Role | Interaction |
|-------|------|-------------|
| **Human (lead)** | Decision-maker at every gate | Triggers work, approves specs, validates review comments, merges |
| **Main Claude (orchestrator)** | Workflow engine | Assesses issues, spawns agents, runs skills, coordinates flow |
| **product-lead agent** | Specialist analyst/writer | Writes analyses and specs, triages issues, interacts with human when spawned |
| **Domain agents** (FE, BE, infra) | Implementers | Write code within their domain boundaries |
| **tester agent** | Test author + reviewer | Writes failing tests first (RED), reviews test coverage during review phase |
| **security-auditor agent** | Security reviewer | Reviews for OWASP vulnerabilities during review phase |
| **architect agent** | Architecture reviewer | Reviews for design patterns and architecture during review phase |
| **fullstack quick fixer** (new) | Post-review fixer | Fixes accepted review comments across the entire stack |
| **doc-writer agent** | Documentation | Updates docs when needed during implementation |

## Expected Behavior

### Happy path

#### Phase 1 — Assessment

1. Human says "develop issue #XXX"
2. Main Claude fetches the GitHub issue, scans for existing documents:
   - `artifacts/analyses/*` — matching analysis
   - `artifacts/specs/*` — matching spec
3. **If a sufficient spec exists** &rarr; skip to Phase 2
4. **If gaps exist** (no issue detail, no analysis, no spec):
   - Main Claude spawns **product-lead** agent
   - Product-lead interacts directly with the human to:
     - Clarify and structure the issue if needed
     - Write the analysis (human approves)
     - Write the spec (human approves)
   - If deeper technical analysis is needed, product-lead requests **architect** agent
   - Once spec is approved, product-lead returns control to Main Claude

#### Phase 2 — Team &amp; Implementation

5. Main Claude determines team composition from spec scope:

   | Change type | Agent |
   |-------------|-------|
   | Frontend | frontend-dev |
   | Backend | backend-dev |
   | CI/CD / config | devops |
   | Any code change | tester (always) |
   | Security-sensitive | security-auditor (during review) |
   | Documentation | doc-writer |

6. Create worktree:
   ```bash
   git worktree add ../roxabi-XXX -b feat/XXX-slug staging
   cd ../roxabi-XXX
   ```

7. **Test-first** (for code changes):
   1. Tester writes failing tests from spec (RED)
   2. Domain agents implement to pass tests (GREEN)
   3. Domain agents refactor (REFACTOR)
   4. Tester verifies and adds edge cases

8. Run all tests + E2E:
   - **Pass** &rarr; create PR
   - **Fail** &rarr; team fixes &rarr; re-test &rarr; loop until green

#### Phase 3 — Review

9. Main Claude spawns **fresh review agents** (new instances, no implementation context):

   | Always | Conditional |
   |--------|-------------|
   | security-auditor | frontend-dev (if FE changes) |
   | architect | backend-dev (if BE changes) |
   | product-lead | devops (if config changes) |
   | tester | |

   Each reviewer produces Conventional Comments scoped to their domain.

10. Main Claude collects all review comments.
11. Main Claude walks the human through each comment **one-by-one** (`/1b1`):
    - Shows the comment, severity, and context
    - Presents trade-offs and recommendations
    - Human decides: accept, reject, or defer

#### Phase 4 — Fix &amp; Merge

12. **Fullstack quick fixer** receives the list of accepted comments and fixes them across the stack.
13. Push changes, update PR.
14. CI runs:
    - **Pass** &rarr; merge &rarr; cleanup worktree
    - **Fail** &rarr; team/fixer investigates and fixes &rarr; CI again &rarr; loop until green
15. Merge:
    ```bash
    gh pr merge <pr-number> --squash --delete-branch
    ```
16. Cleanup:
    ```bash
    cd ../roxabi_boilerplate
    git worktree remove ../roxabi-XXX
    ```

### Edge cases

| Scenario | Handling |
|----------|----------|
| Issue has no analysis or spec | Product-lead creates both gates (analysis &rarr; spec) |
| Spec exists but is outdated | Human validates; product-lead updates if needed |
| Review finds critical security issue | Escalate immediately to human, don't wait for 1b1 |
| CI fails after fixer's changes | Fixer investigates; if systemic, domain agents help |
| All review comments are non-blocking | Human can batch-accept without 1b1 |
| Product-lead needs architecture input | Product-lead spawns architect as sub-agent |
| No tests needed (docs-only change) | Skip test-first phase; proceed to PR directly |

## Constraints

- **Mandatory worktree** for all code changes (no direct commits to staging/main)
- **Human approval at every gate**: spec approval, review comment acceptance, merge decision
- **Fresh agents for review**: no agent reviews code it wrote (prevents bias)
- **Test-first for code changes**: tester writes failing tests before implementation
- **Conventional Commits** for all commits
- **No force push**, no `git add -A`, no `--hard` resets

## Non-goals

- Removing `TeamCreate` / `TeamDelete` from agent configs (keep for future use)
- Self-review checklists in agent `.md` files (review handles quality)
- CLAUDE.md content trimming (separate effort)
- CI pipeline changes (security scanning, docs lint — separate issues)
- Writing actual tests (auth tests, E2E — separate issues)
- Changing the Tier S process (remains as-is)

## Technical Decisions

### 1. Fullstack quick fixer replaces reviewer agent

**Decision:** Remove the dedicated `reviewer` agent. Replace with `fixer` — a fullstack agent that receives specific review comments and fixes them across FE + BE + tests + config.

**Rationale:** The current reviewer tries to review AND fix AND verify CI. Splitting review (multi-domain fresh agents) from fixing (single fixer agent) gives better separation of concerns. The fixer doesn't need domain restrictions because it's fixing specific, identified issues — not writing new code.

### 2. Multi-domain fresh review

**Decision:** Review is performed by fresh instances of security-auditor, architect, product-lead, tester, plus domain agents matching the change scope.

**Rationale:** A single "reviewer" cannot have deep expertise in security, architecture, product fit, test quality, AND frontend/backend patterns. Fresh agents have no bias from implementation. Each reviewer is scoped to what they know best.

### 3. Judgment-based F-lite / F-full

**Decision:** Replace file-count-based tier determination with a judgment-based decision tree.

**F-full (needs bootstrap):**
```
New architectural concepts or patterns?              -> F-full
Unclear or competing requirements?                   -> F-full
Affects >2 domain boundaries?                        -> F-full
```

**F-lite (skip bootstrap):**
```
Mechanical/repetitive regardless of file count?      -> F-lite
Requirements fully documented (analysis/spec exist)? -> F-lite
Single domain, clear scope?                          -> F-lite
```

**Human always validates** the F-lite/F-full classification before proceeding.

**Rationale:** Counter-examples prove file count is broken — a 50-file mechanical change doesn't need bootstrap, while a 3-file rate limiter has significant design decisions. Judgment-based with human validation catches both.

### 4. Test-first ordering

**Decision:** Flip F.5 implementation ordering to test-first (RED &rarr; GREEN &rarr; REFACTOR).

**Rationale:** Aligns `dev-process.mdx` with `testing.mdx` (removes the contradiction). Prevents "we'll add tests later" (which led to zero auth tests). Gives implementation agents a clear, verifiable target.

### 5. Role clarity

| Actor | Role | Does NOT |
|-------|------|----------|
| Human | Decides at every gate, merges | — |
| Main Claude | Orchestrates via skills and Task tool | Does not implement code directly |
| product-lead | Writes artifacts/analyses/specs, triages issues | Does not orchestrate or merge |
| Domain agents | Implement within their packages | Do not review their own code |

## Files to Update

| File | Changes |
|------|---------|
| `docs/processes/dev-process.mdx` | Full Tier F rewrite: F-lite/F-full, test-first, new workflow phases, role clarity |
| `docs/guides/agent-teams.mdx` | Update routing tree, playbooks, agent list (add fixer, update review model) |
| `AGENTS.md` | Update coordination guide: orchestrator model, role descriptions |
| `CLAUDE.md` | Update agent table (reviewer &rarr; fixer), routing decision tree |
| `.claude/agents/reviewer.md` | Rename/rewrite to `fixer.md` — fullstack quick fixer role |

## Success Criteria

- [ ] `dev-process.mdx` documents F-lite / F-full with judgment-based decision tree
- [ ] `dev-process.mdx` Tier F workflow matches the 4-phase flow (assess &rarr; implement &rarr; review &rarr; fix/merge)
- [ ] Test-first ordering documented in F.5 (RED &rarr; GREEN &rarr; REFACTOR)
- [ ] Fullstack quick fixer agent defined in `.claude/agents/fixer.md`
- [ ] Review model documented: fresh multi-domain agents (security + architect + product + tester + domain)
- [ ] Roles clarified across all docs: orchestrator (Main Claude), decision-maker (human), specialists (agents)
- [ ] `CLAUDE.md` agent table and routing tree updated
- [ ] `AGENTS.md` coordination guide updated
- [ ] `docs/guides/agent-teams.mdx` routing and playbooks updated
- [ ] No contradictions between `dev-process.mdx`, `testing.mdx`, and `agent-teams.mdx`

## Open Questions

1. **Should the `/review` skill be updated** to spawn multiple domain reviewers instead of a single reviewer? Or is that a separate issue?
2. **Fixer agent model**: Should the fixer use a heavier model (Opus) since it needs cross-stack understanding, or standard (Sonnet) since fixes are scoped to identified issues?
3. **Review comment format**: Should all review agents use the same Conventional Comments format, or should each domain have its own template (e.g., security uses OWASP checklist)?
