---
title: "web-vitals + Lighthouse CI"
parent_spec: "artifacts/specs/371-observability-stack.mdx"
parent_issue: 371
---

## Scope

Phase 3b — Wire web-vitals to PostHog and add Lighthouse CI to deploy preview workflow. Breadboard IDs: U8, N9, N10.

## Success Criteria

- [ ] `useWebVitals()` hook reports CLS, LCP, TTFB, INP to PostHog as custom events (no FID)
- [ ] web-vitals only reports when PostHog is initialized (consent-gated)
- [ ] Dev mode: metrics logged to console
- [ ] `lighthouserc.json` with thresholds: performance ≥ 75, accessibility ≥ 90
- [ ] `lighthouserc.json` includes `x-vercel-protection-bypass` header
- [ ] Lighthouse CI runs as post-deploy step in `deploy-preview.yml`
- [ ] `deploy-preview.yml` permissions includes `statuses: write`
- [ ] Lighthouse results posted as PR status check
- [ ] Lighthouse uses median of 3 runs

## Reference

Full spec: [artifacts/specs/371-observability-stack.mdx](../specs/371-observability-stack.mdx)
